generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/prisma/vote"
}

datasource db {
  provider = "postgresql"
  url      = env("VOTE_DATABASE_URL")
}

model Vote {
  id              String          @id @db.Uuid
  title           String          @db.VarChar(50)
  type            VoteType
  resultContentId String          @unique @db.Uuid
  contentType     VoteContentType
  createdAt       DateTime
  resultContent   VoteContent     @relation("result", fields: [resultContentId], references: [id])
  contents        VoteContent[]   @relation("contents")
}

model VoteContent {
  id           String          @id @db.Uuid
  time         DateTime        @db.Time(6)
  placeId      String          @unique @db.Uuid
  type         VoteContentType
  voteId       String          @db.Uuid
  selectedVote Vote?           @relation("result")
  place        Place           @relation(fields: [placeId], references: [id])
  vote         Vote            @relation("contents", fields: [voteId], references: [id])
}

model UserVotedContent {
  id            String @id @db.Uuid
  userId        String @db.Uuid
  voteContentId String @db.Uuid
}

model Place {
  id            String       @id @db.Uuid
  title         String       @db.VarChar(20)
  address       String       @db.VarChar(100)
  latitude      Decimal
  longitude     Decimal
  linkedContent VoteContent?
}

enum VoteType {
  RADIO
  CHECKBOX
}

enum VoteContentType {
  PLACE
  TIME
}
